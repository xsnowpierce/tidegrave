[gd_scene load_steps=17 format=3 uid="uid://dt4ibdhjqfriw"]

[ext_resource type="PackedScene" uid="uid://bicr1knp8vkyb" path="res://levels/dungeon1/models/torch_pillar/torch_pillar_object.tscn" id="2_q0r4u"]
[ext_resource type="PackedScene" uid="uid://r5vmjrts3spl" path="res://models/chest/chest_object.tscn" id="3_202ew"]
[ext_resource type="Resource" uid="uid://cfmof8qrvwdmq" path="res://resources/items/armour/chestplate/chestplate.tres" id="4_iqist"]
[ext_resource type="Material" uid="uid://d3eef1eqab0co" path="res://levels/dungeon1/tileset/materials/stone_wall.tres" id="6_5sorg"]
[ext_resource type="Script" uid="uid://dfker8qg5kkku" path="res://scripts/world/wall_door_interactable.gd" id="7_ulpql"]
[ext_resource type="Resource" uid="uid://dbrcymut50xbk" path="res://resources/items/dungeon key/dungeon_key.tres" id="8_qxj5j"]
[ext_resource type="PackedScene" uid="uid://chrdtvwvi0kkj" path="res://resources/items/pickup_item.tscn" id="9_r3gnu"]
[ext_resource type="Environment" uid="uid://cnxq7oyfis56g" path="res://levels/dungeon1/dungeon_environment.tres" id="10_i76xq"]
[ext_resource type="PackedScene" uid="uid://bfrbsfxb557wm" path="res://characters/enemy/skeleton/skeleton.tscn" id="10_slc4o"]
[ext_resource type="ArrayOccluder3D" uid="uid://dlmyy2684pl8s" path="res://levels/dungeon1/test/dungeon1.occ" id="10_ssd7a"]
[ext_resource type="PackedScene" uid="uid://cqb3w7enofd1q" path="res://levels/dungeon1/test/dungeon.glb" id="11_yowmm"]

[sub_resource type="BoxShape3D" id="BoxShape3D_r3gnu"]
size = Vector3(3.40479, 4.50159, 1)

[sub_resource type="BoxShape3D" id="BoxShape3D_qxj5j"]
size = Vector3(3.39655, 3.99292, 1)

[sub_resource type="Animation" id="Animation_qxj5j"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("CSGBox3D:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 2, 0)]
}

[sub_resource type="Animation" id="Animation_ulpql"]
resource_name = "wall_door_open"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("CSGBox3D:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, 2, 0), Vector3(0, 6.02095, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_r3gnu"]
_data = {
&"RESET": SubResource("Animation_qxj5j"),
&"wall_door_open": SubResource("Animation_ulpql")
}

[node name="Dungeon1" type="Node3D"]

[node name="dungeon" parent="." instance=ExtResource("11_yowmm")]
transform = Transform3D(0.75, 0, 0, 0, 0.75, 0, 0, 0, 0.75, 0, 0, 0)

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = ExtResource("10_i76xq")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.538945, 0.709566, -0.453931, -0.554408, 0.106905, 0.82535, 0.634168, 0.696482, 0.335773, 0, 0, 0)
light_energy = 0.2
light_volumetric_fog_energy = 0.0

[node name="OccluderInstance3D" type="OccluderInstance3D" parent="."]
occluder = ExtResource("10_ssd7a")

[node name="Objects" type="Node3D" parent="."]

[node name="torch_pillar" parent="Objects" instance=ExtResource("2_q0r4u")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12.7688, -7.15256e-07, 36.617)

[node name="torch_pillar2" parent="Objects" instance=ExtResource("2_q0r4u")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12.6934, 4.76837e-07, 23.3001)

[node name="torch_pillar3" parent="Objects" instance=ExtResource("2_q0r4u")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.580537, -2.38419e-07, 23.3876)

[node name="Chest" parent="Objects" instance=ExtResource("3_202ew")]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -2.22931, 9.53674e-07, 35.9626)
holding_item = ExtResource("4_iqist")

[node name="Wall Door" type="Area3D" parent="Objects"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, -17.4691, 3.71689, 36.0536)
collision_layer = 32
collision_mask = 16
script = ExtResource("7_ulpql")
door_is_locked = true
required_key = ExtResource("8_qxj5j")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Objects/Wall Door"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0388184, 1.75079, 0)
shape = SubResource("BoxShape3D_r3gnu")

[node name="CSGBox3D" type="CSGBox3D" parent="Objects/Wall Door"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0)
material_override = ExtResource("6_5sorg")
use_collision = true
size = Vector3(3.5, 4, 1)

[node name="StaticBody3D" type="StaticBody3D" parent="Objects/Wall Door/CSGBox3D"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Objects/Wall Door/CSGBox3D/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0448303, 0.00183105, 0)
shape = SubResource("BoxShape3D_qxj5j")

[node name="AnimationPlayer" type="AnimationPlayer" parent="Objects/Wall Door"]
libraries = {
&"": SubResource("AnimationLibrary_r3gnu")
}
speed_scale = 0.5

[node name="Chest2" parent="Objects" instance=ExtResource("3_202ew")]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -0.713746, -1.19209e-07, 36.0513)
holding_item = ExtResource("8_qxj5j")
item_amount = 1

[node name="Pickup Item" parent="Objects" instance=ExtResource("9_r3gnu")]
holding_item = ExtResource("8_qxj5j")

[node name="Enemies" type="Node3D" parent="."]

[node name="Skeleton" parent="Enemies" instance=ExtResource("10_slc4o")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -7.54514, 1.19209e-07, 27.7578)

[node name="Skeleton2" parent="Enemies" instance=ExtResource("10_slc4o")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.99943, 1.19209e-07, 30.6777)
